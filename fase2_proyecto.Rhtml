<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Comprensi√≥n de los Datos</title>
  <link rel="stylesheet" href="styles.css">

  <!-- Estilo para las tarjetas de consultas y resultados -->
  <style>
    .sql-card {
      background: #0f172a;
      color: #e2e8f0;
      padding: 14px 18px;
      border-radius: 12px;
      margin: 16px 0;
      font-size: 13px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.35);
      border: 1px solid #1e293b;
    }

    .sql-title {
      font-weight: 600;
      margin-bottom: 8px;
      color: #f8fafc;
    }

    .result-card {
      background: #ffffff;
      padding: 14px 18px;
      border-radius: 12px;
      margin-top: 8px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.10);
      border: 1px solid #e2e8f0;
    }

    .result-card table {
      width: 100%;
      font-size: 13px;
    }

    .result-card caption {
      font-weight: 600;
      margin-bottom: 6px;
    }
  </style>
</head>

<body>

<div class="page">

  <!-- NAV FASES -->
  <div class="phases-nav">
    <a href="index.html" class="phase-link">Definici√≥n del Proyecto</a>
    <a href="fase2_proyecto.html" class="phase-link active">Comprensi√≥n de los Datos</a>
    <a href="fase3_proyecto.html" class="phase-link">An√°lisis Exploratorio de Datos</a>
  </div>

  <!-- ========== HERO FASE 2 ========== -->
  <div class="hero-container">

    <div class="hero-left">
      <h1 class="hero-title">Comprensi√≥n de los Datos</h1>
      <p class="hero-subtitle">Estructura, calidad y primeras relaciones del dataset</p>

      <div class="hero-badges">
        <span class="hero-badge">Rom√°n Ballesteros Mart√≠nez</span>
        <span class="hero-badge">Zara Sales EDA</span>
        <span class="hero-badge">Fase 2 ¬∑ Organizaci√≥n y Entendimiento</span>
      </div>

      <p class="hero-description">
        En esta fase se estudia el dataset <i>Zara_sales.csv</i> y su versi√≥n en base de datos
        para entender qu√© informaci√≥n contiene, en qu√© estado se encuentra y qu√© primeras
        se√±ales ofrece sobre el comportamiento de las ventas.
      </p>
    </div>

    <div class="hero-right">
      <div class="hero-box">
        <p class="hero-box-title">Resumen de la fase</p>
        <ul class="hero-info-list">
          <li><span>üë§</span> Autor: <b>Rom√°n Ballesteros Mart√≠nez</b></li>
          <li><span>üóÑÔ∏è</span> BD: <b>PostgreSQL (192.168.1.194)</b></li>
          <li><span>üìä</span> Dataset: <b>Zara_sales.csv</b></li>
          <li><span>üîç</span> Trabajo: BD + estructura + calidad del dato</li>
          <li><span>üìà</span> Resultado: dataset listo para el EDA</li>
        </ul>
      </div>
    </div>

  </div>
  <!-- ========== FIN HERO ========== -->

  <!-- ========= CHUNK DE SETUP (R OCULTO) ========= -->
  <!--begin.rcode setup, echo=FALSE, message=FALSE, warning=FALSE
  library(DBI)
  library(RPostgres)
  library(readr)
  library(dplyr)
  library(knitr)

  # Conexi√≥n a PostgreSQL
  con <- dbConnect(
    RPostgres::Postgres(),
    host   = "192.168.1.194",
    port   = 5432,
    dbname = "zara_db",
    user   = "postgres",
    password = "passw0rd!"
  )

  # Carga del CSV (ajusta la ruta si hace falta)
  ventas <- read_csv2("Zara_sales.csv", show_col_types = FALSE)

  # Adaptar nombres de columnas del CSV a los que usaremos en SQL
  ventas <- ventas |>
    rename(
      product_id        = `Product ID`,
      product_position  = `Product Position`,
      promotion         = Promotion,
      sales             = `Sales Volume`,
      price             = price,
      section           = section,
      season            = season,
      terms             = terms,
      origin            = origin
    )

  # Cargar datos en la tabla zara_sales (sobrescribe para asegurar consistencia)
  dbWriteTable(con, "zara_sales", ventas, overwrite = TRUE)
  end.rcode-->

  <!-- ========== CONTENIDO PRINCIPAL ========== -->
  <div class="layout">
    <div>

      <!-- 1. Trabajo con bases de datos -->
      <div class="section-card">
        <div class="section-header">
          <div class="section-number">1</div>
          <div>
            <p class="section-title">Trabajo con bases de datos</p>
            <p class="section-subtitle">PostgreSQL en m√°quina remota 192.168.1.194</p>
          </div>
        </div>

        <div class="section-body">
          <p>
            Como parte de la Fase 2 se cre√≥ una base de datos en <b>PostgreSQL</b> y se carg√≥ el dataset
            en la tabla <code>zara_sales</code>. Esto permite ejecutar consultas SQL reales relacionadas
            con el proyecto y obtener una primera visi√≥n del comportamiento comercial.
          </p>

          <p><b>Esquema l√≥gico de la tabla <code>zara_sales</code>:</b></p>

          <table class="timeline-table">
            <tr><th>Columna</th><th>Tipo</th><th>Descripci√≥n</th></tr>
            <tr><td>product_id</td><td>INTEGER</td><td>ID √∫nico del producto</td></tr>
            <tr><td>section</td><td>TEXT</td><td>Secci√≥n (MAN / WOMAN)</td></tr>
            <tr><td>season</td><td>TEXT</td><td>Temporada principal</td></tr>
            <tr><td>terms</td><td>TEXT</td><td>Subtemporada / colecci√≥n</td></tr>
            <tr><td>origin</td><td>TEXT</td><td>Pa√≠s de fabricaci√≥n</td></tr>
            <tr><td>product_position</td><td>TEXT</td><td>Posici√≥n en tienda (Front / Middle / Back)</td></tr>
            <tr><td>price</td><td>NUMERIC</td><td>Precio unitario</td></tr>
            <tr><td>sales</td><td>INTEGER</td><td>Unidades vendidas</td></tr>
            <tr><td>promotion</td><td>TEXT</td><td>Promoci√≥n (Yes/No)</td></tr>
          </table>

          <p><b>Conexi√≥n desde R:</b></p>
          <pre><code>
con <- DBI::dbConnect(
  RPostgres::Postgres(),
  host   = "192.168.1.194",
  port   = 5432,
  dbname = "zara_db",
  user   = "postgres",
  password = "passw0rd!"
)
          </code></pre>

          <p><b>Consultas SQL realizadas y resultados:</b></p>

          <!-- 1) Productos por secci√≥n -->
          <div class="sql-card">
            <div class="sql-title">1) Productos por secci√≥n</div>
            <code>
SELECT section, COUNT(*) AS num_productos
FROM zara_sales
GROUP BY section;
            </code>
          </div>

          <!--begin.rcode echo=FALSE, results='asis'
          res1 <- dbGetQuery(con, "
            SELECT section, COUNT(*) AS num_productos
            FROM zara_sales
            GROUP BY section;
          ")

          html <- paste0(
            '<div class="result-card">',
            kable(res1, format="html", table.attr='class="table"'),
            '</div>'
          )

          cat(html)
          end.rcode-->

          <!-- 2) Ventas por temporada -->
          <div class="sql-card">
            <div class="sql-title">2) Ventas por temporada</div>
            <code>
SELECT season,
       AVG(sales) AS avg_sales,
       SUM(sales) AS total_sales
FROM zara_sales
GROUP BY season;
            </code>
          </div>

          <!--begin.rcode echo=FALSE, results='asis'
          res2 <- dbGetQuery(con, "
            SELECT season,
                   AVG(sales) AS avg_sales,
                   SUM(sales) AS total_sales
            FROM zara_sales
            GROUP BY season;
          ")

          html <- paste0(
            '<div class="result-card">',
            kable(res2, format="html", table.attr='class="table"'),
            '</div>'
          )

          cat(html)
          end.rcode-->

          <!-- 3) Ventas por rangos de precio -->
          <div class="sql-card">
            <div class="sql-title">3) Ventas por rangos de precio</div>
            <code>
SELECT CASE
  WHEN price &lt; 20 THEN 'Bajo'
  WHEN price BETWEEN 20 AND 39.99 THEN 'Medio'
  ELSE 'Alto' END AS rango_precio,
  AVG(sales) AS avg_sales,
  COUNT(*) AS num_productos
FROM zara_sales
GROUP BY rango_precio;
            </code>
          </div>

          <!--begin.rcode echo=FALSE, results='asis'
          res3 <- dbGetQuery(con, "
            SELECT CASE
              WHEN price < 20 THEN 'Bajo'
              WHEN price BETWEEN 20 AND 39.99 THEN 'Medio'
              ELSE 'Alto'
            END AS rango_precio,
            AVG(sales) AS avg_sales,
            COUNT(*) AS num_productos
            FROM zara_sales
            GROUP BY rango_precio;
          ")

          html <- paste0(
            '<div class="result-card">',
            kable(res3, format="html", table.attr='class="table"'),
            '</div>'
          )

          cat(html)
          end.rcode-->

          <!-- 4) Promoci√≥n vs ventas -->
          <div class="sql-card">
            <div class="sql-title">4) Promoci√≥n vs ventas</div>
            <code>
SELECT promotion,
       AVG(sales) AS avg_sales,
       SUM(sales) AS total_sales
FROM zara_sales
GROUP BY promotion;
            </code>
          </div>

          <!--begin.rcode echo=FALSE, results='asis'
          res4 <- dbGetQuery(con, "
            SELECT promotion,
                   AVG(sales) AS avg_sales,
                   SUM(sales) AS total_sales
            FROM zara_sales
            GROUP BY promotion;
          ")

          html <- paste0(
            '<div class="result-card">',
            kable(res4, format="html", table.attr='class="table"'),
            '</div>'
          )

          cat(html)
          end.rcode-->

          <!-- 5) Ventas por origen -->
          <div class="sql-card">
            <div class="sql-title">5) Ventas por origen</div>
            <code>
SELECT origin,
       AVG(sales) AS avg_sales,
       SUM(sales) AS total_sales
FROM zara_sales
GROUP BY origin;
            </code>
          </div>

          <!--begin.rcode echo=FALSE, results='asis'
          res5 <- dbGetQuery(con, "
            SELECT origin,
                   AVG(sales) AS avg_sales,
                   SUM(sales) AS total_sales
            FROM zara_sales
            GROUP BY origin;
          ")

          html <- paste0(
            '<div class="result-card">',
            kable(res5, format="html", table.attr='class="table"'),
            '</div>'
          )

          cat(html)
          end.rcode-->

          <!-- 6) Ventas por posici√≥n en tienda -->
          <div class="sql-card">
            <div class="sql-title">6) Ventas por posici√≥n en tienda</div>
            <code>
SELECT product_position,
       AVG(sales) AS avg_sales,
       COUNT(*) AS num_productos
FROM zara_sales
GROUP BY product_position;
            </code>
          </div>

          <!--begin.rcode echo=FALSE, results='asis'
          res6 <- dbGetQuery(con, "
            SELECT product_position,
                   AVG(sales) AS avg_sales,
                   COUNT(*) AS num_productos
            FROM zara_sales
            GROUP BY product_position;
          ")

          html <- paste0(
            '<div class="result-card">',
            kable(res6, format="html", table.attr='class="table"'),
            '</div>'
          )

          cat(html)
          end.rcode-->

          <!-- 7) Ventas por colecci√≥n (terms) -->
          <div class="sql-card">
            <div class="sql-title">7) Ventas por colecci√≥n (terms)</div>
            <code>
SELECT terms,
       AVG(sales) AS avg_sales,
       SUM(sales) AS total_sales
FROM zara_sales
GROUP BY terms;
            </code>
          </div>

          <!--begin.rcode echo=FALSE, results='asis'
          res7 <- dbGetQuery(con, "
            SELECT terms,
                   AVG(sales) AS avg_sales,
                   SUM(sales) AS total_sales
            FROM zara_sales
            GROUP BY terms;
          ")

          html <- paste0(
            '<div class="result-card">',
            kable(res7, format="html", table.attr='class="table"'),
            '</div>'
          )

          cat(html)
          end.rcode-->

        </div>
      </div>

      <!-- 2. Descripci√≥n general -->
      <div class="section-card">
        <div class="section-header">
          <div class="section-number">2</div>
          <div>
            <p class="section-title">Descripci√≥n general del dataset</p>
            <p class="section-subtitle">Contexto y contenido b√°sico</p>
          </div>
        </div>

        <div class="section-body">

          <p><b>Variables principales del dataset:</b></p>

          <table class="timeline-table">
            <tr><th>Variable</th><th>Tipo</th><th>Ejemplo</th><th>Rol</th></tr>
            <tr><td>price</td><td>Num√©rica</td><td>29.99</td><td>Relaci√≥n con ventas</td></tr>
            <tr><td>sales</td><td>Num√©rica</td><td>120</td><td>Rendimiento comercial</td></tr>
            <tr><td>section</td><td>Categ√≥rica</td><td>WOMAN</td><td>Comparaci√≥n entre l√≠neas</td></tr>
            <tr><td>season</td><td>Categ√≥rica</td><td>SS</td><td>Efecto estacional</td></tr>
            <tr><td>promotion</td><td>Categ√≥rica</td><td>Yes</td><td>Impacto promocional</td></tr>
            <tr><td>origin</td><td>Categ√≥rica</td><td>Turkey</td><td>Posible relaci√≥n con calidad/coste</td></tr>
            <tr><td>terms</td><td>Categ√≥rica</td><td>Early SS</td><td>Ciclos dentro de temporada</td></tr>
            <tr><td>product_position</td><td>Categ√≥rica</td><td>Front</td><td>Visibilidad en tienda</td></tr>
          </table>

        </div>
      </div>

      <!-- 3. Calidad del dato -->
      <div class="section-card">
        <div class="section-header">
          <div class="section-number">3</div>
          <div>
            <p class="section-title">Calidad del dato</p>
            <p class="section-subtitle">Valores ausentes, duplicados e inconsistencias</p>
          </div>
        </div>

        <div class="section-body">
          <p><b>Aspectos evaluados:</b></p>

          <table class="timeline-table">
            <tr><th>Aspecto</th><th>Hallazgo</th><th>Acci√≥n Fase 3</th></tr>
            <tr><td>Valores ausentes</td><td>Presentes en algunas columnas</td><td>Imputar o eliminar</td></tr>
            <tr><td>Duplicados</td><td>Posibles filas repetidas</td><td>Eliminar duplicados</td></tr>
            <tr><td>Categor√≠as inconsistentes</td><td>Diferencias en escritura</td><td>Estandarizar etiquetas</td></tr>
            <tr><td>Outliers</td><td>Ventas y precios extremos</td><td>Evaluaci√≥n caso a caso</td></tr>
          </table>

        </div>
      </div>

      <!-- 4. Conclusiones -->
      <div class="section-card">
        <div class="section-header">
          <div class="section-number">4</div>
          <div>
            <p class="section-title">Conclusiones preliminares</p>
            <p class="section-subtitle">Insights iniciales para el negocio</p>
          </div>
        </div>

        <div class="section-body">
          <p>
            Las variables <b>origin</b>, <b>terms</b> y <b>product_position</b> abren nuevas l√≠neas
            estrat√©gicas:
          </p>

          <ul>
            <li>El origen puede estar asociado a percepci√≥n de calidad y ritmos de rotaci√≥n.</li>
            <li>Las subtemporadas permiten identificar ventanas cortas de alta demanda.</li>
            <li>La posici√≥n f√≠sica en tienda puede tener un impacto directo en ventas.</li>
          </ul>

          <p>
            En conjunto, el dataset est√° listo para pasar a la Fase 3 (EDA), donde se explorar√°n
            patrones visuales, distribuciones y relaciones entre variables.
          </p>
        </div>
      </div>

    </div>
  </div>

  <!-- Cerrar conexi√≥n al final del documento -->
  <!--begin.rcode echo=FALSE
  DBI::dbDisconnect(con)
  end.rcode-->

</div>

</body>
</html>
